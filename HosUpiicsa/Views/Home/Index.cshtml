@model IEnumerable<HosUpiicsa.Models.Hotel>
@{
    ViewData["Title"] = "Inicio - Oceano Azul";
    var visitas = Context.Items["Visitas"] as int? ?? 0;
    var hoteles = Model ?? Enumerable.Empty<HosUpiicsa.Models.Hotel>();
}

<!-- Parcial -->
<partial name="_Header" />

<!-- carrusel hero-section -->
<section class="hero-section">
    <div id="mainCarousel" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-indicators">
            <button type="button" data-bs-target="#mainCarousel" data-bs-slide-to="0" class="active"></button>
            <button type="button" data-bs-target="#mainCarousel" data-bs-slide-to="1"></button>
            <button type="button" data-bs-target="#mainCarousel" data-bs-slide-to="2"></button>
        </div>
        
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="~/images/cancun-hero.jpg" class="d-block w-100" alt="Cancún">
                <div class="carousel-caption d-none d-md-block">
                    <h2>Descubre Cancún</h2>
                    <p>Las mejores playas del Caribe Mexicano</p>
                </div>
            </div>
            <div class="carousel-item">
                <img src="~/images/acapulco-hero.jpg" class="d-block w-100" alt="Acapulco">
                <div class="carousel-caption d-none d-md-block">
                    <h2>Experiencia Acapulco</h2>
                    <p>La noche más emocionante</p>
                </div>
            </div>
            <div class="carousel-item">
                <img src="~/images/vallarta-hero.jpg" class="d-block w-100" alt="Puerto Vallarta">
                <div class="carousel-caption d-none d-md-block">
                    <h2>Puerto Vallarta</h2>
                    <p>Donde el mar se encuentra con la montaña</p>
                </div>
            </div>
        </div>
        
        <button class="carousel-control-prev" type="button" data-bs-target="#mainCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon"></span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#mainCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon"></span>
        </button>
    </div>
</section>

<!--busquedarapida-->
<section class="quick-search py-4 bg-light">
    <div class="container">
        <form asp-controller="Habitaciones" asp-action="Index" method="get" class="row g-3">
            <div class="col-md-3">
                <select class="form-select" name="destino">
                    <option value="">Todos los destinos</option>
                    <option value="Cancún">Cancún</option>
                    <option value="Acapulco">Acapulco</option>
                    <option value="Puerto Vallarta">Puerto Vallarta</option>
                </select>
            </div>
            <div class="col-md-3">
                <input type="date" class="form-control" name="fechaEntrada" min="@DateTime.Today.ToString("yyyy-MM-dd")">
            </div>
            <div class="col-md-3">
                <input type="date" class="form-control" name="fechaSalida" min="@DateTime.Today.AddDays(1).ToString("yyyy-MM-dd")">
            </div>
            <div class="col-md-3">
                <button type="submit" class="btn btn-primary w-100">
                    <i class="bi bi-search"></i> Buscar
                </button>
            </div>
        </form>
    </div>
</section>

<!--hotelillos top -->
<section class="featured-hotels py-5">
    <div class="container">
        <h2 class="text-center mb-5">Nuestros Hoteles Destacados</h2>
        
        @if (!hoteles.Any())
        {
            <div class="alert alert-warning text-center">
                No hay hoteles disponibles en este momento.
            </div>
        }
        else
        {
            <div class="row">
                @foreach (var hotel in hoteles.Take(3))
                {
                    <div class="col-md-4 mb-4">
                        <div class="card h-100">
                            <img src="@Url.Content($"~/images/hoteles/{hotel.id_hotel}.jpg")" class="card-img-top" alt="@hotel.getNomHotel()" onerror="this.src='~/images/default-hotel.jpg'">
                            <div class="card-body">
                                <h5 class="card-title">@hotel.getNomHotel()</h5>
                                <p class="card-text">@hotel.getUbicacion()</p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="badge bg-primary">@hotel.tipo_hotel</span>
                                    <a href="@Url.Action("Details", "Hoteles", new { id = hotel.id_hotel })" class="btn btn-sm btn-outline-primary">Ver detalles</a>
                                </div>
                            </div>
                        </div>
                    </div>
                }
            </div>
        }
    </div>
</section>

<!-- Static Map -->
<section class="map-section py-5 bg-light">
    <div class="container">
        <h2 class="text-center mb-5">Nuestros Destinos</h2>
        <div class="text-center">
            <img src="https://maps.googleapis.com/maps/api/staticmap?center=Mexico&zoom=5&size=800x400&markers=color:red%7CCancun&markers=color:red%7CAcapulco&markers=color:red%7CPuerto+Vallarta&key=TU_API_KEY" 
                 alt="Mapa de destinos" class="img-fluid rounded shadow">
        </div>
    </div>
</section>

<!-- Visit Counter -->
<div class="visit-counter py-3 bg-dark text-white text-center">
    <div class="container">
        <p class="mb-0">Visitas totales: @visitas</p>
    </div>
</div>

<!--Partial -->
<partial name="_Footer" />

@section Styles {
    <style>
        .hero-section {
            margin-top: -56px; 
        }
        
        .carousel-item {
            height: 70vh;
            min-height: 400px;
        }
        
        .carousel-item img {
            object-fit: cover;
            height: 100%;
        }
        
        .quick-search {
            margin-top: -50px;
            position: relative;
            z-index: 1000;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .featured-hotels .card {
            transition: transform 0.3s;
        }
        
        .featured-hotels .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        .visit-counter {
            font-size: 1.2rem;
            font-weight: 500;
        }
        
        @@media (max-width: 768px) {
            .carousel-item {
                height: 50vh;
            }
            
            .quick-search {
                margin-top: 0;
                border-radius: 0;
            }
        }
    </style>
}

@section Scripts {
    <script>
        $(document).ready(function() {
            // Inicializar carrusel
            $('#mainCarousel').carousel({
                interval: 5000
            });
            
            //.....fechitas
            const today = new Date().toISOString().split('T')[0];
            $('input[name="fechaEntrada"]').attr('min', today);
            
            $('input[name="fechaEntrada"]').change(function() {
                const checkInDate = $(this).val();
                $('input[name="fechaSalida"]').attr('min', checkInDate);
                
                //....
                if ($('input[name="fechaSalida"]').val() < checkInDate) {
                    const nextDay = new Date(checkInDate);
                    nextDay.setDate(nextDay.getDate() + 1);
                    $('input[name="fechaSalida"]').val(nextDay.toISOString().split('T')[0]);
                }
            });
        });
    </script>
}